"use strict";(self.webpackChunkcoreui_free_angular_admin_template=self.webpackChunkcoreui_free_angular_admin_template||[]).push([[102],{7102:(q,g,r)=>{r.r(g),r.d(g,{ExcalinestModule:()=>x});var c=r(6895),f=r(1334),l=r(433),o=r(7911),d=r(593),e=r(1571),m=r(529),_=r(2340);let v=(()=>{class i{constructor(t,n){this.http=t,this.router=n,this.apiUrl=_.N.apiUrl+"admin-application",this.headers=new m.WM({enctype:"multipart/form-data"})}postApplication(t){const n=new FormData;return n.append("title",t.title),n.append("description",t.description),n.append("archivoApp",t.appFile),this.http.post(`${this.apiUrl}/post`,n,{headers:this.headers})}deleteApplication(t){return this.http.delete(`${this.apiUrl}/delete`,{headers:new m.WM({"Content-Type":"application/json"}),body:t})}getAll(){return this.http.get(`${this.apiUrl}/get-all`)}getZipFile(t){return this.http.post(`${this.apiUrl}/get-zip-file`,t,{responseType:"blob"})}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(m.eN),e.LFG(d.F0))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function b(i,s){1&i&&(e.TgZ(0,"div",6),e._UZ(1,"i",7),e.TgZ(2,"span",8),e._uU(3,"Cargando aplicaciones..."),e.qZA()())}function C(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",13)(6,"button",14),e.NdJ("click",function(){const p=e.CHM(t).$implicit,u=e.oxw(2);return e.KtG(u.downloadFile(p))}),e.O4$(),e._UZ(7,"svg",15),e._uU(8,"Descargar"),e.qZA()()()}if(2&i){const t=s.$implicit;e.xp6(2),e.Oqu(t.title),e.xp6(2),e.Oqu(t.description)}}function Z(i,s){if(1&i&&(e.TgZ(0,"div")(1,"div",9)(2,"table",10)(3,"thead")(4,"tr")(5,"th",11),e._uU(6,"Versi\xf3n"),e.qZA(),e.TgZ(7,"th",11),e._uU(8,"Descripci\xf3n"),e.qZA(),e._UZ(9,"th",11),e.qZA()(),e.TgZ(10,"tbody"),e.YNc(11,C,9,2,"tr",12),e.qZA()()()()),2&i){const t=e.oxw();e.xp6(11),e.Q6J("ngForOf",t.versions)}}let F=(()=>{class i{constructor(t){this.applicationService=t,this.versions=new Array,this.showSpinner=!1,this.modalMessage="",this.modalTitle="Atenci\xf3n",this.visible=!1,this.error=!1}ngOnInit(){this.showSpinner=!0,this.applicationService.getAll().subscribe({error:t=>{this.modalMessage=t.error.replace(/['"]+/g,""),this.openCloseInfoModal()},next:t=>{this.showSpinner=!1,0==t.length&&(this.modalMessage="A\xfan no hay versiones de Excalinest - Desktop publicadas.",this.openCloseInfoModal()),this.versions=t,console.log(this.versions)}})}downloadFile(t){this.showSpinner=!0,this.applicationService.getZipFile({filename:t.title+".zip"}).subscribe({error:a=>{this.showSpinner=!1,this.modalMessage=a.error.replace(/['"]+/g,""),this.openCloseInfoModal()},next:a=>{const p=t.title+".zip",u=window.URL.createObjectURL(a),h=document.createElement("a");h.href=u,h.download=p,h.click(),window.URL.revokeObjectURL(u),this.showSpinner=!1}})}openCloseInfoModal(){this.visible=!this.visible}handleInfoModalChange(t){this.visible=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(v))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-get-applications"]],decls:12,vars:6,consts:[["class","fade show spinner",4,"ngIf"],[4,"ngIf"],["id","infoModal",3,"visible","alignment","visibleChange"],["cModalTitle",""],["cButtonClose","",3,"click"],["cButton","","color","secondary",3,"click"],[1,"fade","show","spinner"],[1,"spinner-grow","spinner-grow-sm"],["id","spinner",1,"m-1"],[1,"table-responsive"],[1,"table","table-striped","versions-table"],["scope","col"],[4,"ngFor","ngForOf"],[1,"center-content"],["cButton","","color","dark","size","sm",3,"click"],["cIcon","","name","cilCloudDownload",1,"me-2","icon"]],template:function(t,n){1&t&&(e.YNc(0,b,4,0,"div",0),e.YNc(1,Z,12,1,"div",1),e.TgZ(2,"c-modal",2),e.NdJ("visibleChange",function(p){return n.handleInfoModalChange(p)}),e.TgZ(3,"c-modal-header")(4,"h5",3),e._uU(5),e.qZA(),e.TgZ(6,"button",4),e.NdJ("click",function(){return n.openCloseInfoModal()}),e.qZA()(),e.TgZ(7,"c-modal-body"),e._uU(8),e.qZA(),e.TgZ(9,"c-modal-footer")(10,"button",5),e.NdJ("click",function(){return n.openCloseInfoModal()}),e._uU(11," Cerrar "),e.qZA()()()),2&t&&(e.Q6J("ngIf",n.showSpinner),e.xp6(1),e.Q6J("ngIf",0==n.showSpinner),e.xp6(1),e.Q6J("visible",n.visible)("alignment","center"),e.xp6(3),e.Oqu(n.modalTitle),e.xp6(3),e.hij(" ",n.modalMessage," "))},dependencies:[c.sg,c.O5,f.ar,o.Hq3,o.PFQ,o.KF4,o.YI7,o.Rbl,o.vPP,o.zS7],styles:[".versions-table[_ngcontent-%COMP%]{margin-bottom:5%}.center-content[_ngcontent-%COMP%]{text-align:center;vertical-align:middle}.spinner[_ngcontent-%COMP%]{text-align:center;padding-top:33.3333333333vh;height:50vh}.update-button[_ngcontent-%COMP%]{width:100%}.row[_ngcontent-%COMP%]{margin-top:2%}.row-margin-bottom[_ngcontent-%COMP%]{margin-bottom:10%}"]}),i})();function T(i,s){1&i&&(e.TgZ(0,"div",6),e._UZ(1,"i",7),e.TgZ(2,"span",8),e._uU(3,"Publicando aplicaci\xf3n..."),e.qZA()())}function w(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"h2"),e._uU(2,"Publicar Excalinest"),e.qZA(),e.TgZ(3,"form",9),e.NdJ("ngSubmit",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.submitApplication())}),e.TgZ(4,"c-row")(5,"c-col",10)(6,"label",11),e._uU(7,"Nombre de la nueva versi\xf3n"),e.qZA(),e._UZ(8,"input",12),e.TgZ(9,"c-form-feedback",13),e._uU(10,"Nombre de la versi\xf3n v\xe1lido"),e.qZA(),e.TgZ(11,"c-form-feedback",13),e._uU(12,"Ingrese el nombre de la nueva versi\xf3n"),e.qZA()(),e.TgZ(13,"c-col",10)(14,"label",14),e._uU(15,"Archivo zip de la aplicaci\xf3n"),e.qZA(),e.TgZ(16,"input",15),e.NdJ("change",function(a){e.CHM(t);const p=e.oxw();return e.KtG(p.onAppFileChange(a))}),e.qZA(),e.TgZ(17,"c-form-feedback",13),e._uU(18,"Archivo v\xe1lido"),e.qZA(),e.TgZ(19,"c-form-feedback",13),e._uU(20,"Ingrese el archivo"),e.qZA()()(),e.TgZ(21,"c-row")(22,"c-col",16)(23,"label",17),e._uU(24,"Descripci\xf3n"),e.qZA(),e._UZ(25,"textarea",18),e.TgZ(26,"c-form-feedback",13),e._uU(27,"Descripci\xf3n v\xe1lida"),e.qZA(),e.TgZ(28,"c-form-feedback",13),e._uU(29,"Ingrese la descripci\xf3n"),e.qZA()()(),e.TgZ(30,"c-row",19)(31,"c-col",20)(32,"button",21),e._uU(33," Publicar "),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(3),e.Q6J("formGroup",t.getPostApplicationForm())("validated",t.validatedForm),e.xp6(6),e.Q6J("valid",!0),e.xp6(2),e.Q6J("valid",!1),e.xp6(6),e.Q6J("valid",!0),e.xp6(2),e.Q6J("valid",!1),e.xp6(7),e.Q6J("valid",!0),e.xp6(2),e.Q6J("valid",!1)}}let M=(()=>{class i{constructor(t,n,a){this.applicationService=t,this.formBuilder=n,this.router=a,this.postApplicationForm=new l.cw({}),this.validatedForm=!1,this.newApplication={title:"",description:"",bucketId:"",appFile:new File([],"")},this.showSpinner=!1,this.modalMessage="",this.modalTitle="Atenci\xf3n",this.visible=!1,this.error=!1}getPostApplicationForm(){return this.postApplicationForm}ngOnInit(){this.postApplicationForm=this.formBuilder.group({title:["",l.kI.required],description:["",l.kI.required],zip:["",l.kI.required]})}onAppFileChange(t){const a=t.target.files?.[0];a&&(this.newApplication.appFile=a)}onPostApplication(){this.newApplication.title=this.postApplicationForm.value.title,this.newApplication.description=this.postApplicationForm.value.description,this.showSpinner=!0,this.applicationService.postApplication(this.newApplication).subscribe({error:t=>{this.showSpinner=!1,this.error=!0,this.modalMessage=t.error.replace(/['"]+/g,""),this.openCloseInfoModal(!1)},next:t=>{this.showSpinner=!1,this.error=!1,this.modalMessage=t.replace(/['"]+/g,""),this.openCloseInfoModal(!0)}})}submitApplication(){this.validatedForm=!0,this.postApplicationForm.dirty&&this.postApplicationForm.valid&&this.onPostApplication()}openCloseInfoModal(t){this.visible=!this.visible,t?this.visible&&t&&this.resetForm():this.completeForm(),!this.visible&&!this.error&&this.router.navigate(["/applications"])}handleInfoModalChange(t){this.visible=t}resetForm(){this.validatedForm=!1,this.postApplicationForm=this.formBuilder.group({title:["",l.kI.required],description:["",l.kI.required],zip:["",l.kI.required]})}completeForm(){this.validatedForm=!1,this.postApplicationForm=this.formBuilder.group({title:[this.newApplication.title,l.kI.required],description:[this.newApplication.description,l.kI.required],zip:["",l.kI.required]})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(v),e.Y36(l.qu),e.Y36(d.F0))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-post-application"]],decls:12,vars:6,consts:[["class","fade show spinner",4,"ngIf"],[4,"ngIf"],["id","infoModal",3,"visible","alignment","visibleChange"],["cModalTitle",""],["cButtonClose","",3,"click"],["cButton","","color","secondary",3,"click"],[1,"fade","show","spinner"],[1,"spinner-grow","spinner-grow-sm"],[1,"m-1"],["cForm","",1,"row","g-3","needs-validation",3,"formGroup","validated","ngSubmit"],["md","6"],["cLabel","","for","title"],["cFormControl","","id","title","formControlName","title","required","","type","text"],[3,"valid"],["cLabel","","for","zip"],["cFormControl","","id","zip","formControlName","zip","accept","application/zip","required","","type","file",3,"change"],["md","12"],["cLabel","","for","description"],["cFormControl","","id","description","formControlName","description","required","","type","text"],[1,"row"],["md","4"],["cButton","","color","primary","type","submit",1,"update-button","row-margin-bottom"]],template:function(t,n){1&t&&(e.YNc(0,T,4,0,"div",0),e.YNc(1,w,34,8,"div",1),e.TgZ(2,"c-modal",2),e.NdJ("visibleChange",function(p){return n.handleInfoModalChange(p)}),e.TgZ(3,"c-modal-header")(4,"h5",3),e._uU(5),e.qZA(),e.TgZ(6,"button",4),e.NdJ("click",function(){return n.openCloseInfoModal(!1)}),e.qZA()(),e.TgZ(7,"c-modal-body"),e._uU(8),e.qZA(),e.TgZ(9,"c-modal-footer")(10,"button",5),e.NdJ("click",function(){return n.openCloseInfoModal(!1)}),e._uU(11," Cerrar "),e.qZA()()()),2&t&&(e.Q6J("ngIf",n.showSpinner),e.xp6(1),e.Q6J("ngIf",0==n.showSpinner),e.xp6(1),e.Q6J("visible",n.visible)("alignment","center"),e.xp6(3),e.Oqu(n.modalTitle),e.xp6(3),e.hij(" ",n.modalMessage," "))},dependencies:[c.O5,o.iok,o.Yp0,o.$_X,o.oHf,o.dCl,o.eFW,o.Hq3,o.PFQ,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.sg,l.u,o.KF4,o.YI7,o.Rbl,o.vPP,o.zS7],styles:[".spinner[_ngcontent-%COMP%]{text-align:center;padding-top:33.3333333333vh;height:50vh}.update-button[_ngcontent-%COMP%]{width:100%}.row[_ngcontent-%COMP%]{margin-top:2%}.row-margin-bottom[_ngcontent-%COMP%]{margin-bottom:10%}"]}),i})();var A=r(2993);const I=[{path:"",redirectTo:"get-all",pathMatch:"full"},{path:"",data:{title:"Aplicaciones"},children:[{path:"",pathMatch:"full",redirectTo:"colors"},{path:"get-all",component:F,data:{title:"Lista de versiones de Excalinest",usuario:"admin-soporte"},canActivate:[A.a]},{path:"post",component:M,data:{title:"Publicar nueva versi\xf3n de Excalinest",usuario:"soporte"},canActivate:[A.a]}]}];let U=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[d.Bz.forChild(I),d.Bz]}),i})(),x=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[c.ez,U,o.dTQ,o.zE6,o.gzQ,f.QX,o.dGk,o.P4_,o.ejP,o.hJ1,l.u5,l.UX,o.ga2,o.kWm,o.m81,o.Xo8,o.zkK]}),i})()}}]);
"use strict";(self.webpackChunkcoreui_free_angular_admin_template=self.webpackChunkcoreui_free_angular_admin_template||[]).push([[102],{7102:(I,f,a)=>{a.r(f),a.d(f,{ExcalinestModule:()=>c});var m=a(6895),v=a(1334),l=a(433),o=a(6602),g=a(593),t=a(1571),_=a(529),A=a(2340);class r{constructor(e,i){this.http=e,this.router=i,this.apiUrl=A.N.apiUrl+"admin-application"}postApplication(e){return this.http.post(`${this.apiUrl}/post`,e)}deleteApplication(e){return this.http.delete(`${this.apiUrl}/delete`,{headers:new _.WM({"Content-Type":"application/json"}),body:e})}getAll(){return this.http.get(`${this.apiUrl}/get-all`)}getZipFile(e){return this.http.post(`${this.apiUrl}/get-zip-file`,e,{responseType:"text"})}}function b(n,e){1&n&&(t.TgZ(0,"div",6),t._UZ(1,"i",7),t.TgZ(2,"span",8),t._uU(3,"Cargando aplicaciones..."),t.qZA()())}function C(n,e){if(1&n){const i=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",13)(6,"button",14),t.NdJ("click",function(){const M=t.CHM(i).$implicit,x=t.oxw(2);return t.KtG(x.downloadFile(M))}),t.O4$(),t._UZ(7,"svg",15),t._uU(8,"Descargar"),t.qZA()()()}if(2&n){const i=e.$implicit;t.xp6(2),t.Oqu(i.title),t.xp6(2),t.Oqu(i.description)}}function Z(n,e){if(1&n&&(t.TgZ(0,"div")(1,"div",9)(2,"table",10)(3,"thead")(4,"tr")(5,"th",11),t._uU(6,"Versi\xf3n"),t.qZA(),t.TgZ(7,"th",11),t._uU(8,"Descripci\xf3n"),t.qZA(),t._UZ(9,"th",11),t.qZA()(),t.TgZ(10,"tbody"),t.YNc(11,C,9,2,"tr",12),t.qZA()()()()),2&n){const i=t.oxw();t.xp6(11),t.Q6J("ngForOf",i.versions)}}r.\u0275fac=function(e){return new(e||r)(t.LFG(_.eN),t.LFG(g.F0))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"});class h{constructor(e){this.applicationService=e,this.versions=new Array,this.excalinestDownloadsPath="C:\\Excalinest\\",this.showSpinner=!1,this.modalMessage="",this.modalTitle="Atenci\xf3n",this.visible=!1,this.error=!1}ngOnInit(){this.showSpinner=!0,this.applicationService.getAll().subscribe({error:e=>{this.modalMessage=e.error.replace(/['"]+/g,""),this.openCloseInfoModal()},next:e=>{this.showSpinner=!1,0==e.length&&(this.modalMessage="A\xfan no hay versiones de Excalinest - Desktop publicadas.",this.openCloseInfoModal()),this.versions=e,console.log(this.versions)}})}downloadFile(e){this.showSpinner=!0,this.applicationService.getZipFile({destPath:this.excalinestDownloadsPath,filename:e.title+".zip"}).subscribe({error:s=>{this.showSpinner=!1,this.modalMessage=s.error.replace(/['"]+/g,""),this.openCloseInfoModal()},next:s=>{this.showSpinner=!1,this.modalMessage=s+" Excalinest coloca el archivo en C:\\Excalinest",this.openCloseInfoModal()}})}openCloseInfoModal(){this.visible=!this.visible}handleInfoModalChange(e){this.visible=e}}function F(n,e){1&n&&(t.TgZ(0,"div",6),t._UZ(1,"i",7),t.TgZ(2,"span",8),t._uU(3,"Publicando aplicaci\xf3n..."),t.qZA()())}function T(n,e){if(1&n){const i=t.EpF();t.TgZ(0,"div")(1,"h2"),t._uU(2,"Publicar Excalinest"),t.qZA(),t.TgZ(3,"form",9),t.NdJ("ngSubmit",function(){t.CHM(i);const d=t.oxw();return t.KtG(d.submitApplication())}),t.TgZ(4,"c-row")(5,"c-col",10)(6,"label",11),t._uU(7,"Nombre de la nueva versi\xf3n"),t.qZA(),t._UZ(8,"input",12),t.TgZ(9,"c-form-feedback",13),t._uU(10,"Nombre de la versi\xf3n v\xe1lido"),t.qZA(),t.TgZ(11,"c-form-feedback",13),t._uU(12,"Ingrese el nombre de la nueva versi\xf3n"),t.qZA()(),t.TgZ(13,"c-col",10)(14,"label",14),t._uU(15,"Archivo zip de la aplicaci\xf3n"),t.qZA(),t._UZ(16,"input",15),t.TgZ(17,"c-form-feedback",13),t._uU(18,"Archivo v\xe1lido"),t.qZA(),t.TgZ(19,"c-form-feedback",13),t._uU(20,"Ingrese el archivo"),t.qZA()()(),t.TgZ(21,"c-row")(22,"c-col",16)(23,"label",17),t._uU(24,"Descripci\xf3n"),t.qZA(),t._UZ(25,"textarea",18),t.TgZ(26,"c-form-feedback",13),t._uU(27,"Descripci\xf3n v\xe1lida"),t.qZA(),t.TgZ(28,"c-form-feedback",13),t._uU(29,"Ingrese la descripci\xf3n"),t.qZA()()(),t.TgZ(30,"c-row",19)(31,"c-col",20)(32,"button",21),t._uU(33," Publicar "),t.qZA()()()()()}if(2&n){const i=t.oxw();t.xp6(3),t.Q6J("formGroup",i.getPostApplicationForm())("validated",i.validatedForm),t.xp6(6),t.Q6J("valid",!0),t.xp6(2),t.Q6J("valid",!1),t.xp6(6),t.Q6J("valid",!0),t.xp6(2),t.Q6J("valid",!1),t.xp6(7),t.Q6J("valid",!0),t.xp6(2),t.Q6J("valid",!1)}}h.\u0275fac=function(e){return new(e||h)(t.Y36(r))},h.\u0275cmp=t.Xpm({type:h,selectors:[["app-get-applications"]],decls:12,vars:6,consts:[["class","fade show spinner",4,"ngIf"],[4,"ngIf"],["id","infoModal",3,"visible","alignment","visibleChange"],["cModalTitle",""],["cButtonClose","",3,"click"],["cButton","","color","secondary",3,"click"],[1,"fade","show","spinner"],[1,"spinner-grow","spinner-grow-sm"],[1,"m-1"],[1,"table-responsive"],[1,"table","table-striped","versions-table"],["scope","col"],[4,"ngFor","ngForOf"],[1,"center-content"],["cButton","","color","dark","size","sm",3,"click"],["cIcon","","name","cilCloudDownload",1,"me-2","icon"]],template:function(e,i){1&e&&(t.YNc(0,b,4,0,"div",0),t.YNc(1,Z,12,1,"div",1),t.TgZ(2,"c-modal",2),t.NdJ("visibleChange",function(d){return i.handleInfoModalChange(d)}),t.TgZ(3,"c-modal-header")(4,"h5",3),t._uU(5),t.qZA(),t.TgZ(6,"button",4),t.NdJ("click",function(){return i.openCloseInfoModal()}),t.qZA()(),t.TgZ(7,"c-modal-body"),t._uU(8),t.qZA(),t.TgZ(9,"c-modal-footer")(10,"button",5),t.NdJ("click",function(){return i.openCloseInfoModal()}),t._uU(11," Cerrar "),t.qZA()()()),2&e&&(t.Q6J("ngIf",i.showSpinner),t.xp6(1),t.Q6J("ngIf",0==i.showSpinner),t.xp6(1),t.Q6J("visible",i.visible)("alignment","center"),t.xp6(3),t.Oqu(i.modalTitle),t.xp6(3),t.hij(" ",i.modalMessage," "))},dependencies:[m.sg,m.O5,v.ar,o.Hq3,o.PFQ,o.KF4,o.YI7,o.Rbl,o.vPP,o.zS7],styles:[".versions-table[_ngcontent-%COMP%]{margin-bottom:5%}.center-content[_ngcontent-%COMP%]{text-align:center;vertical-align:middle}.spinner[_ngcontent-%COMP%]{text-align:center;padding-top:33.3333333333vh;height:50vh}.update-button[_ngcontent-%COMP%]{width:100%}.row[_ngcontent-%COMP%]{margin-top:2%}.row-margin-bottom[_ngcontent-%COMP%]{margin-bottom:10%}"]});class u{constructor(e,i,s){this.applicationService=e,this.formBuilder=i,this.router=s,this.postApplicationForm=new l.cw({}),this.validatedForm=!1,this.excalinestAppPath="C:\\Excalinest\\app\\",this.fakePath="C:\\fakepath\\",this.newApplication={title:"",description:"",filepath:"",bucketId:""},this.showSpinner=!1,this.modalMessage="",this.modalTitle="Atenci\xf3n",this.visible=!1,this.error=!1}getPostApplicationForm(){return this.postApplicationForm}ngOnInit(){this.postApplicationForm=this.formBuilder.group({title:["",l.kI.required],description:["",l.kI.required],zip:["",l.kI.required]})}onPostApplication(){this.newApplication.title=this.postApplicationForm.value.title,this.newApplication.description=this.postApplicationForm.value.description,this.newApplication.filepath=this.postApplicationForm.value.zip.replace(this.fakePath,this.excalinestAppPath),this.showSpinner=!0,this.applicationService.postApplication(this.newApplication).subscribe({error:e=>{this.showSpinner=!1,this.error=!0,this.modalMessage=e.error.replace(/['"]+/g,""),this.openCloseInfoModal(!1)},next:e=>{this.showSpinner=!1,this.error=!1,this.modalMessage=e.replace(/['"]+/g,""),this.openCloseInfoModal(!0)}})}submitApplication(){this.validatedForm=!0,this.postApplicationForm.dirty&&this.postApplicationForm.valid&&this.onPostApplication()}openCloseInfoModal(e){this.visible=!this.visible,e?this.visible&&e&&this.resetForm():this.completeForm(),!this.visible&&!this.error&&this.router.navigate(["/applications"])}handleInfoModalChange(e){this.visible=e}resetForm(){this.validatedForm=!1,this.postApplicationForm=this.formBuilder.group({title:["",l.kI.required],description:["",l.kI.required],zip:["",l.kI.required]})}completeForm(){this.validatedForm=!1,this.postApplicationForm=this.formBuilder.group({title:[this.newApplication.title,l.kI.required],description:[this.newApplication.description,l.kI.required],zip:["",l.kI.required]})}}u.\u0275fac=function(e){return new(e||u)(t.Y36(r),t.Y36(l.qu),t.Y36(g.F0))},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-post-application"]],decls:12,vars:6,consts:[["class","fade show spinner",4,"ngIf"],[4,"ngIf"],["id","infoModal",3,"visible","alignment","visibleChange"],["cModalTitle",""],["cButtonClose","",3,"click"],["cButton","","color","secondary",3,"click"],[1,"fade","show","spinner"],[1,"spinner-grow","spinner-grow-sm"],[1,"m-1"],["cForm","",1,"row","g-3","needs-validation",3,"formGroup","validated","ngSubmit"],["md","6"],["cLabel","","for","title"],["cFormControl","","id","title","formControlName","title","required","","type","text"],[3,"valid"],["cLabel","","for","zip"],["cFormControl","","id","zip","formControlName","zip","accept","application/zip","required","","type","file"],["md","12"],["cLabel","","for","description"],["cFormControl","","id","description","formControlName","description","required","","type","text"],[1,"row"],["md","4"],["cButton","","color","primary","type","submit",1,"update-button","row-margin-bottom"]],template:function(e,i){1&e&&(t.YNc(0,F,4,0,"div",0),t.YNc(1,T,34,8,"div",1),t.TgZ(2,"c-modal",2),t.NdJ("visibleChange",function(d){return i.handleInfoModalChange(d)}),t.TgZ(3,"c-modal-header")(4,"h5",3),t._uU(5),t.qZA(),t.TgZ(6,"button",4),t.NdJ("click",function(){return i.openCloseInfoModal(!1)}),t.qZA()(),t.TgZ(7,"c-modal-body"),t._uU(8),t.qZA(),t.TgZ(9,"c-modal-footer")(10,"button",5),t.NdJ("click",function(){return i.openCloseInfoModal(!1)}),t._uU(11," Cerrar "),t.qZA()()()),2&e&&(t.Q6J("ngIf",i.showSpinner),t.xp6(1),t.Q6J("ngIf",0==i.showSpinner),t.xp6(1),t.Q6J("visible",i.visible)("alignment","center"),t.xp6(3),t.Oqu(i.modalTitle),t.xp6(3),t.hij(" ",i.modalMessage," "))},dependencies:[m.O5,o.iok,o.Yp0,o.$_X,o.oHf,o.dCl,o.eFW,o.Hq3,o.PFQ,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.sg,l.u,o.KF4,o.YI7,o.Rbl,o.vPP,o.zS7],styles:[".spinner[_ngcontent-%COMP%]{text-align:center;padding-top:33.3333333333vh;height:50vh}.update-button[_ngcontent-%COMP%]{width:100%}.row[_ngcontent-%COMP%]{margin-top:2%}.row-margin-bottom[_ngcontent-%COMP%]{margin-bottom:10%}"]});const w=[{path:"",redirectTo:"get-all",pathMatch:"full"},{path:"",data:{title:"Aplicaciones"},children:[{path:"",pathMatch:"full",redirectTo:"colors"},{path:"get-all",component:h,data:{title:"Lista de versiones de Excalinest"}},{path:"post",component:u,data:{title:"Publicar nueva versi\xf3n de Excalinest"}}]}];class p{}p.\u0275fac=function(e){return new(e||p)},p.\u0275mod=t.oAB({type:p}),p.\u0275inj=t.cJS({imports:[g.Bz.forChild(w),g.Bz]});class c{}c.\u0275fac=function(e){return new(e||c)},c.\u0275mod=t.oAB({type:c}),c.\u0275inj=t.cJS({imports:[m.ez,p,o.dTQ,o.zE6,o.gzQ,v.QX,o.dGk,o.P4_,o.ejP,o.hJ1,l.u5,l.UX,o.ga2,o.kWm,o.m81,o.Xo8,o.zkK]})}}]);